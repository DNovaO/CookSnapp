{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Explore Recipes</title>
    <link rel="icon" href="{% static 'resources/cooksnap-logo.png' %}" alt="CookSnapIcon" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" crossorigin="anonymous" />
    <link rel="stylesheet" href="{% static 'styles/stylePreferences.css' %}" />
    <link rel="stylesheet" href="{% static 'styles/styleCirculos.css' %}" />
</head>

<body class="background">
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light p-3">
        <a class="navbar-brand" href="{% url 'main' %}">
            <img src="{% static 'resources/cooksnap-logo.png' %}" alt="Cooksnap Logo" class="hexagon-img" style="min-width:150px; height:auto;" />
        </a>
        <div class="collapse navbar-collapse" id="navbarNav">
            <h1 class="nav-link mb-0 text-center text-lg-start fw-bold fs-5 text-dark">
                Welcome <span style="color:#FF5535">{{ user.username }}</span>! Ready to start cooking?
            </h1>
        </div>
    </nav>

    <!-- Background Animation -->
    <ul class="circles">
        {% for _ in "12345678901234567890"%}
        <li></li>
        {% endfor %}
    </ul>

    <!-- Main Content -->
    <div class="container mt-5 mb-5 bg-light rounded custom-container" style="margin:0 auto; z-index:1;">
        <!-- Title -->
        <h1 class="mt-3 mb-4">Let's improve your <span style="color:#FF5535">cooking</span> preferences!</h1>

        <!-- Formulario de Preferencias -->
        <form method="POST" action="{% url 'main' %}">
        {% csrf_token %}
        <!-- Step 1: Select Allergies -->
        <div class="d-flex justify-content-left mt-3 mb-4 step" id="step1">
            <div class="row mb-3">
                <label for="cookingLevel" class="form-label ms-2 fs-5 fw-bold">Select your specific allergies</label>
                <div class="row g-3">
                    {% for allergy in allergies %}
                    <div class="col-6 col-md-4 col-lg-3">
                        <label class="custom-card">
                            <input type="checkbox" class="form-check-input d-none" name="allergies" value="{{ allergy }}">
                            <div class="custom-card-body">
                                {{ allergy }}
                            </div>
                        </label>
                    </div>
                    {% endfor %}
                </div>

                <!-- Agregar alergia personalizada -->
                <div class="col-12 mt-4">
                    <label for="customAllergy" class="form-label fw-bold">Add Your Allergy:</label>
                    <div class="d-flex">
                        <input type="text" id="customAllergy" class="form-control me-2" placeholder="Type your allergy" />
                        <button type="button" id="addAllergyBtn" class="btn btn-success">Add</button>
                    </div>
                </div>
                <div id="customAllergiesList" class="row g-3 mt-3"></div>
            </div>
        </div>

        <!-- Step 2: Nutritional Preferences -->
        <div class="d-flex justify-content-start mt-3 mb-4 step d-none" id="step2">
            <fieldset class="row mb-3">
                <legend class="form-label fs-5 fw-bold">Do you want to know the nutritional information?</legend>
                <div class="col-12 col-md-4">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="lowCalories" name="nutrition" value="Low Calories">
                        <label class="form-check-label" for="lowCalories">Yes</label>
                    </div>
                </div>
                <div class="col-12 col-md-4">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="highProtein" name="nutrition" value="High Protein">
                        <label class="form-check-label" for="highProtein">No</label>
                    </div>
                </div>
            </fieldset>
        </div>
        
        <!-- Step 3: Cooking Level -->
        <div class="d-flex justify-content-start mt-3 mb-4 step d-none" id="step3">
            <div class="row mb-3">
                <label for="cookingLevel" class="form-label ms-2 fs-5 fw-bold">What's your cooking level?</label>
                <select id="cookingLevel" class="form-select ms-3" name="cooking_level" aria-label="Select your cooking level">
                    <option value="" disabled selected>Select your level</option>
                    <option value="Beginner">Beginner</option>
                    <option value="Intermediate">Intermediate</option>
                    <option value="Advanced">Advanced</option>
                </select>
            </div>
        </div>
        
        <!-- Step 4: Summary -->
        <div class="d-flex flex-column align-items-start mt-3 mb-4 step d-none" id="step4">
            <h4 class="mb-3">Review your preferences and submit!</h4>
            <div class="row w-100">
                <div id="summary" class="col-12 col-md-8 col-lg-6 mx-auto p-3 border rounded bg-white">
                    <h5 class="fw-bold">Summary:</h5>
                    <ul id="summaryList" class="list-unstyled">
                        <li><strong>Allergies:</strong> <span id="summaryAllergies">None</span></li>
                        <li><strong>Nutritional Goals:</strong> <span id="summaryNutrition">None</span></li>
                        <li><strong>Cooking Level:</strong> <span id="summaryCookingLevel">None</span></li>
                    </ul>
                </div>
            </div>
        </div>

            <!-- Botones de navegaciÃ³n -->
            <div class="button-group mb-5">
                <button id="prevBtn" class="btn btn-enviar" type="button">Previous</button>
                <button id="nextBtn" class="btn btn-enviar" type="button">Next</button>
                <button id="submitBtn" class="btn btn-enviar d-none" type="submit">Submit</button>
            </div>
        </form>
        
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"> </script>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script src="{% static 'scripts/customPreferences.js' %}"></script>
    <!-- Background Circles Script -->
    <script>
        jQuery(document).ready(function () {
            jQuery(".container-wrap").append(
                "<ul class='circles'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>"
            );
        });
    </script>
</body>
</html>